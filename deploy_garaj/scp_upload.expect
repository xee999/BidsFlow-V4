#!/usr/bin/expect -f
set timeout -1
set local_file [lindex $argv 0]
set port [lindex $argv 1]
set remote_user [lindex $argv 2]
set remote_host [lindex $argv 3]
set remote_path [lindex $argv 4]
set password [lindex $argv 5]

spawn scp -o StrictHostKeyChecking=no -P $port $local_file $remote_user@$remote_host:$remote_path
expect {
  "password:" { send "$password\r" }
  timeout { puts "Connection timed out"; exit 1 }
}
expect eof
